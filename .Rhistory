seq.POSIXt(last_date, length.out = nrow(list_df[[1]]),
units = "seconds", by = .004)
list_df[[11]]
last_date <- strptime("00:00.000",  format = "%M:%OS")
for (ind in seq(1, length(list_df))){
list_df[[ind] <- cbind(list_df[ind], seq.POSIXt(last_date, length.out = nrow(list_df[[ind]]),
last_date <- strptime("00:00.000",  format = "%M:%OS")
for (ind in seq(1, length(list_df))){
list_df[[ind]] <- cbind(list_df[[ind]], seq.POSIXt(last_date, length.out = nrow(list_df[[ind]]),
units = "seconds", by = .004))
colnames(list_df[[ind]]) <- c(colnames(list_df[[ind]]), "Время")
}
lsit_df[[1]]
list_df[[1]]
for (ind in seq(1, length(list_df))){
list_df[[ind]] <- list_df[[ind]][, c(1:(length(list_df[[ind]])-1))]
}
list_df[[1]][, c(1:(length(list_df[[1]])-1))]
list_df[[1]]
colnames(list_df[[1]])
c(colnames(list_df[[1]]), "Time")
start_date <- strptime("00:00.000",  format = "%M:%OS")
for (ind in seq(1, length(list_df))){
list_df[[ind]] <- cbind(list_df[[ind]], seq.POSIXt(start_date, length.out = nrow(list_df[[ind]]),
units = "seconds", by = .004))
colnames(list_df[[ind]]) <- c(colnames(list_df[[ind]]), "Время")
}
list_df[[1]]
ncol(list_df[[1]])
colnames(list_df[[1]])
download.file("https://raw.githubusercontent.com/qwerty29544/RpracticeBook/master/2Data/01FlatTables/ECG_yurchenkov.txt",
destfile = "data.txt")
#-------------------(2)
df <- read.csv("data.txt", skip = 47, header = T, sep = '\t')
#-------------------(3)
names <- paste("канал_", c(1:(length(df) - 1)))
colnames(df) <- c("Период", names)
#-------------------(4)
#which(df[, 2] == '', arr.ind=T) -> сколько неинформативных строк в каждом блоке перед новой серией
list_df <- list()
cur_ind <- 1
index_vec <- which(df[, 1] == 0, arr.ind=T)
for (ind in seq(1, length(index_vec))){
if (ind == 1){
list_df[[cur_ind]] <- df[c(1:(index_vec[ind] - 7)), ]
cur_ind <- cur_ind + 1
} else {
list_df[[cur_ind]] <- df[c(index_vec[ind-1]:(index_vec[ind] - 7)), ]
cur_ind <- cur_ind + 1
}
}
list_df[cur_ind] <- df[c(index_vec[ind-1]:length(df)), ]
#количество опытов
length(list_df)
list_df[[1]]
start_date <- strptime("00:00.000",  format = "%M:%OS")
for (ind in seq(1, length(list_df))){
list_df[[ind]] <- cbind(list_df[[ind]], seq.POSIXt(start_date, length.out = nrow(list_df[[ind]]),
units = "seconds", by = .004))
colnames(list_df[[ind]]) <- c("Период", names, "Время")
}
list_df[[1]]
#-------------------(1)
download.file("https://raw.githubusercontent.com/qwerty29544/RpracticeBook/master/2Data/01FlatTables/ECG_yurchenkov.txt",
destfile = "data.txt")
#-------------------(2)
df <- read.csv("data.txt", skip = 47, header = T, sep = '\t')
#-------------------(3)
names <- paste("канал_", c(1:(length(df) - 1)))
colnames(df) <- c("Период", names)
#-------------------(4)
#which(df[, 2] == '', arr.ind=T) -> сколько неинформативных строк в каждом блоке перед новой серией
list_df <- list()
cur_ind <- 1
index_vec <- which(df[, 1] == 0, arr.ind=T)
for (ind in seq(1, length(index_vec))){
if (ind == 1){
list_df[[cur_ind]] <- df[c(1:(index_vec[ind] - 7)), ]
cur_ind <- cur_ind + 1
} else {
list_df[[cur_ind]] <- df[c(index_vec[ind-1]:(index_vec[ind] - 7)), ]
cur_ind <- cur_ind + 1
}
}
list_df[cur_ind] <- df[c(index_vec[ind-1]:length(df)), ]
#количество опытов
length(list_df)
seq.POSIXt(start_date, length.out = nrow(list_df[[ind]]),
units = "seconds", by = .004, format = "%H:%M:%OS")
for (ind in seq(1, length(list_df))){
list_df[[ind]] <- cbind(list_df[[ind]], seq.POSIXt(start_date, length.out = nrow(list_df[[ind]]),
units = "seconds", by = .004, format = "%H:%M:OS"))
colnames(list_df[[ind]]) <- c("Период", names, "Время")
}
list_df[[1]]
list_df <- list()
cur_ind <- 1
index_vec <- which(df[, 1] == 0, arr.ind=T)
for (ind in seq(1, length(index_vec))){
if (ind == 1){
list_df[[cur_ind]] <- df[c(1:(index_vec[ind] - 7)), ]
cur_ind <- cur_ind + 1
} else {
list_df[[cur_ind]] <- df[c(index_vec[ind-1]:(index_vec[ind] - 7)), ]
cur_ind <- cur_ind + 1
}
}
list_df[cur_ind] <- df[c(index_vec[ind-1]:length(df)), ]
#количество опытов
length(list_df)
start_date <- strptime("00:00.000",  format = "%M:%OS")
for (ind in seq(1, length(list_df))){
list_df[[ind]] <- cbind(list_df[[ind]], strprime(seq.POSIXt(start_date, length.out = nrow(list_df[[ind]]),
units = "seconds", by = .004, format = "%H:%M:OS"), format = "%M:%OS"))
colnames(list_df[[ind]]) <- c("Период", names, "Время")
}
start_date <- strptime("00:00.000",  format = "%M:%OS")
for (ind in seq(1, length(list_df))){
list_df[[ind]] <- cbind(list_df[[ind]], strptime(seq.POSIXt(start_date, length.out = nrow(list_df[[ind]]),
units = "seconds", by = .004, format = "%H:%M:OS"), format = "%M:%OS"))
colnames(list_df[[ind]]) <- c("Период", names, "Время")
}
list_df[[1]]
strptime(seq.POSIXt(start_date, length.out = nrow(list_df[[ind]]),
units = "seconds", by = .004, format = "%H:%M:OS"), format = "%M:%OS")
list_df <- list()
cur_ind <- 1
index_vec <- which(df[, 1] == 0, arr.ind=T)
for (ind in seq(1, length(index_vec))){
if (ind == 1){
list_df[[cur_ind]] <- df[c(1:(index_vec[ind] - 7)), ]
cur_ind <- cur_ind + 1
} else {
list_df[[cur_ind]] <- df[c(index_vec[ind-1]:(index_vec[ind] - 7)), ]
cur_ind <- cur_ind + 1
}
}
list_df[cur_ind] <- df[c(index_vec[ind-1]:length(df)), ]
#количество опытов
length(list_df)
seq.POSIXt(start_date, length.out = nrow(list_df[[ind]]),
units = "seconds", by = .004, format = "%M:OS")
cbind(list_df[[ind]], seq.POSIXt(start_date, length.out = nrow(list_df[[ind]]),
units = "seconds", by = .004, format = "%M:OS"))
for (ind in seq(1, length(list_df))){
summary(list_df[[1]][, c(2:6)])
}
summary(df)
for (ind in seq(1, length(list_df))){
print(summary(list_df[[1]][, c(2:6)]))
}
summary(df)
for (ind in seq(1, length(list_df))){
list_df[[ind]][, c(2:6)] <- apply(list_df[[ind]][, c(2:6)], MARGIN = 2, FUN = as.numeric)
print(summary(list_df[[ind]][, c(2:6)]))
}
for (ind in seq(1, length(list_df))){
list_df[[ind]][, c(2:6)] <- apply(list_df[[ind]][, c(2:6)], MARGIN = 2, FUN = as.numeric)
print(summary(list_df[[ind]][, c(2:6)]))
}
summary(df)
df <- apply(df[, c(2:6)], MARGIN = 2, FUN = as.numeric)
summary(df)
#-------------------(2)
df <- read.csv("data.txt", skip = 47, header = T, sep = '\t')
for (ind in seq(1, length(list_df))){
list_df[[ind]][, c(2:6)] <- apply(list_df[[ind]][, c(2:6)], MARGIN = 2, FUN = as.numeric)
print(summary(list_df[[ind]][, c(2:6)]))
}
for (ind in seq(1, length(list_df))){
list_df[[ind]][, c(2:6)] <- apply(list_df[[ind]][, c(2:6)], MARGIN = 2, FUN = as.numeric)
}
names <- paste("канал_", c(1:(length(df) - 1)))
colnames(df) <- c("Период", names)
#-------------------(4)
#which(df[, 2] == '', arr.ind=T) -> сколько неинформативных строк в каждом блоке перед новой серией
list_df <- list()
cur_ind <- 1
index_vec <- which(df[, 1] == 0, arr.ind=T)
for (ind in seq(1, length(index_vec))){
if (ind == 1){
list_df[[cur_ind]] <- df[c(1:(index_vec[ind] - 7)), ]
cur_ind <- cur_ind + 1
} else {
list_df[[cur_ind]] <- df[c(index_vec[ind-1]:(index_vec[ind] - 7)), ]
cur_ind <- cur_ind + 1
}
}
list_df[cur_ind] <- df[c(index_vec[ind-1]:length(df)), ]
#количество опытов
length(list_df)
#-------------------(5)
start_date <- strptime("00:00.000",  format = "%M:%OS")
for (ind in seq(1, length(list_df))){
list_df[[ind]] <- cbind(list_df[[ind]], seq.POSIXt(start_date, length.out = nrow(list_df[[ind]]),
units = "seconds", by = .004, format = "%M:OS"))
colnames(list_df[[ind]]) <- c("Период", names, "Время")
}
#-------------------(6)
for (ind in seq(1, length(list_df))){
list_df[[ind]][, c(2:6)] <- apply(list_df[[ind]][, c(2:6)], MARGIN = 2, FUN = as.numeric)
}
apply(list_df[[ind]][, c(2:6)], MARGIN = 2, FUN = as.numeric)
list_df[[ind]][, c(2:6)]
list_df[[1]]
names <- paste("канал_", c(1:(length(df) - 1)))
colnames(df) <- c("Период", names)
#-------------------(4)
#which(df[, 2] == '', arr.ind=T) -> сколько неинформативных строк в каждом блоке перед новой серией
list_df <- list()
cur_ind <- 1
index_vec <- which(df[, 1] == 0, arr.ind=T)
for (ind in seq(1, length(index_vec))){
if (ind == 1){
list_df[[cur_ind]] <- df[c(1:(index_vec[ind] - 7)), ]
cur_ind <- cur_ind + 1
} else {
list_df[[cur_ind]] <- df[c(index_vec[ind-1]:(index_vec[ind] - 7)), ]
cur_ind <- cur_ind + 1
}
}
list_df[cur_ind] <- df[c(index_vec[ind-1]:length(df)), ]
#количество опытов
length(list_df)
#-------------------(5)
start_date <- strptime("00:00.000",  format = "%M:%OS")
for (ind in seq(1, length(list_df))){
list_df[[ind]] <- cbind(list_df[[ind]], seq.POSIXt(start_date, length.out = nrow(list_df[[ind]]),
units = "seconds", by = .004, format = "%M:OS"))
colnames(list_df[[ind]]) <- c("Период", names, "Время")
}
list_df[[1]]
is.na(list_df[[1]])
sum(is.na(list_df[[1]]))
for (ind in seq(1, length(list_df))){
list_df[[ind]][, c(2:6)] <- apply(list_df[[ind]][, c(2:6)], MARGIN = 2, FUN = as.numeric)
}
is.na(list_df[[1]])
df <- read.csv("data.txt", skip = 47, header = T, sep = '\t')
#-------------------(3)
names <- paste("канал_", c(1:(length(df) - 1)))
colnames(df) <- c("Период", names)
#-------------------(4)
#which(df[, 2] == '', arr.ind=T) -> сколько неинформативных строк в каждом блоке перед новой серией
list_df <- list()
cur_ind <- 1
index_vec <- which(df[, 1] == 0, arr.ind=T)
for (ind in seq(1, length(index_vec))){
if (ind == 1){
list_df[[cur_ind]] <- df[c(1:(index_vec[ind] - 7)), ]
cur_ind <- cur_ind + 1
} else {
list_df[[cur_ind]] <- df[c(index_vec[ind-1]:(index_vec[ind] - 7)), ]
cur_ind <- cur_ind + 1
}
}
list_df[cur_ind] <- df[c(index_vec[ind-1]:length(df)), ]
#количество опытов
length(list_df)
#-------------------(5)
start_date <- strptime("00:00.000",  format = "%M:%OS")
for (ind in seq(1, length(list_df))){
list_df[[ind]] <- cbind(list_df[[ind]], seq.POSIXt(start_date, length.out = nrow(list_df[[ind]]),
units = "seconds", by = .004, format = "%M:OS"))
colnames(list_df[[ind]]) <- c("Период", names, "Время")
}
as.numeric(3,6)
as.numeric(3.6)
as.numeric('3,6')
as.numeric('3.6')
numeric('3,6')
stringr::str_replace_all("3,6 4,5 5 6,7", ',', '.')
correct_numeric <- function(x){
x <- stringr::str_replace_all(x, ',', '.')
return(as.numeric(x))
}
for (ind in seq(1, length(list_df))){
list_df[[ind]][, c(2:6)] <- apply(list_df[[ind]][, c(2:6)], MARGIN = 2, FUN = correct_numeric)
}
list_df[[1]]
for (ind in seq(1, length(list_df))){
print(ind)
print(summary(list_df[[ind]][, c(2:6)]))
print("--------")
}
lsit_df[[13]]
list_df[[13]]
df[c(index_vec[ind-1]:length(df)), ]
df[c(index_vec[length(vec) - 1]:length(df)), ]
df[c(index_vec[length(index_vec) - 1]:length(df)), ]
names <- paste("канал_", c(1:(length(df) - 1)))
colnames(df) <- c("Период", names)
#-------------------(4)
#which(df[, 2] == '', arr.ind=T) -> сколько неинформативных строк в каждом блоке перед новой серией
list_df <- list()
cur_ind <- 1
index_vec <- which(df[, 1] == 0, arr.ind=T)
for (ind in seq(1, length(index_vec))){
if (ind == 1){
list_df[[cur_ind]] <- df[c(1:(index_vec[ind] - 7)), ]
cur_ind <- cur_ind + 1
} else {
list_df[[cur_ind]] <- df[c(index_vec[ind-1]:(index_vec[ind] - 7)), ]
cur_ind <- cur_ind + 1
}
}
list_df[cur_ind] <- df[c(index_vec[length(index_vec)-1]:length(df)), ]
#количество опытов
length(list_df)
#-------------------(5)
start_date <- strptime("00:00.000",  format = "%M:%OS")
for (ind in seq(1, length(list_df))){
list_df[[ind]] <- cbind(list_df[[ind]], seq.POSIXt(start_date, length.out = nrow(list_df[[ind]]),
units = "seconds", by = .004, format = "%M:OS"))
colnames(list_df[[ind]]) <- c("Период", names, "Время")
}
correct_numeric <- function(x){
x <- stringr::str_replace_all(x, ',', '.')
return(as.numeric(x))
}
for (ind in seq(1, length(list_df))){
list_df[[ind]][, c(2:6)] <- apply(list_df[[ind]][, c(2:6)], MARGIN = 2, FUN = correct_numeric)
}
for (ind in seq(1, length(list_df))){
print(ind)
print(summary(list_df[[ind]][, c(2:6)]))
print("--------")
}
library(ggplot2)
ggplot()+
geom_line(x=list_df[[1]][, 7], y=list_df[[1]][, 3])
ggplot()+
geom_line(x=list_df[[1]][, 7], y=list_df[[1]][, 3])+
labs(title = "Временной ряд для серии 1 и канала 2")
list_df[[1]]
?seq.POSIXt
seq.POSIXt(start_date, length.out = nrow(list_df[[1]]),
units = "seconds", by = .004, format = "%M:OS")
list_df[[1]][, "канал_ 1"]
View(df)
names <- paste("канал_", c(1:(length(df) - 1)))
colnames(df) <- c("Период", names)
#-------------------(4)
#which(df[, 2] == '', arr.ind=T) -> сколько неинформативных строк в каждом блоке перед новой серией
list_df <- list()
cur_ind <- 1
index_vec <- which(df[, 1] == 0, arr.ind=T)
for (ind in seq(1, length(index_vec))){
if (ind == 1){
list_df[[cur_ind]] <- df[c(1:(index_vec[ind] - 7)), ]
cur_ind <- cur_ind + 1
} else {
list_df[[cur_ind]] <- df[c(index_vec[ind-1]:(index_vec[ind] - 7)), ]
cur_ind <- cur_ind + 1
}
}
list_df[cur_ind] <- df[c(index_vec[length(index_vec)-1]:length(df)), ]
#количество опытов
length(list_df)
#-------------------(5)
start_date <- strptime("00:00.000",  format = "%M:%OS")
for (ind in seq(1, length(list_df))){
list_df[[ind]][, "Время"] <-  seq.POSIXt(start_date, length.out = nrow(list_df[[ind]]),
units = "seconds", by = .004, format = "%M:OS")
colnames(list_df[[ind]]) <- c("Период", names, "Время")
}
}
for (ind in seq(1, length(list_df))){
list_df[[ind]][, c(2:6)] <- apply(list_df[[ind]][, c(2:6)], MARGIN = 2, FUN = correct_numeric)
}
for (ind in seq(1, length(list_df))){
print(ind)
print(summary(list_df[[ind]][, c(2:6)]))
print("--------")
}
list_df[[1]]
alter_johns <- function(y){
result <- c()
for (tau in c(1:length(y) - 1)){
sup_y <- y[c((1 + tau):length(y))]
sup_y <- sup_y - y[c(1:(length(y) - tau))]
a_tau <- sum(sup_y) / (length(y) - tau)
result <- c(result, a_tau)
}
return(result)
}
#График ВР можно построить для любой серии, изменяя индекс
library(ggplot2)
ggplot()+
geom_line(x=list_df[[1]][, 7], y=list_df[[1]][, 3])+
labs(title = "Временной ряд для серии 1 и канала 2")
seq.POSIXt(from = start_date, to = start_date + 0.004 * length(list_df[[1]])
units = "seconds", by = .004, format = "%M:OS")
seq.POSIXt(from = start_date, to = start_date + 0.004 * length(list_df[[1]]),
units = "seconds", by = .004, format = "%M:OS")
seq.POSIXt(from = start_date, to = start_date + length(list_df[[1]]),
units = "seconds", by = .004, format = "%M:OS")
start_date <- strptime("00:00.000",  format = "%M:%OS")
for (ind in seq(1, length(list_df))){
list_df[[ind]][, "Время"] <-  seq.POSIXt(from = start_date, to = start_date + length(list_df[[1]]),
units = "seconds", by = .004, format = "%M:OS")
colnames(list_df[[ind]]) <- c("Период", names, "Время")
}
for (ind in seq(1, length(list_df))){
list_df[[ind]][, "Время"] <-  seq.POSIXt(from = start_date, to = start_date + 0.004 * length(list_df[[1]]),
units = "seconds", by = .004, format = "%M:OS")
colnames(list_df[[ind]]) <- c("Период", names, "Время")
}
start_date <- strptime("00:00.000",  format = "%M:%OS")
for (ind in seq(1, length(list_df))){
list_df[[ind]][, "Время"] <-  seq.POSIXt(from = start_date, to = start_date + 0.004 * nrow(list_df[[1]]),
units = "seconds", by = .004, format = "%M:OS")
colnames(list_df[[ind]]) <- c("Период", names, "Время")
}
start_date <- strptime("00:00.000",  format = "%M:%OS")
for (ind in seq(1, length(list_df))){
list_df[[ind]][, "Время"] <-  seq.POSIXt(from = start_date, to = start_date + 0.004 * nrow(list_df[[ind]]),
units = "seconds", by = .004, format = "%M:OS")
colnames(list_df[[ind]]) <- c("Период", names, "Время")
}
start_date <- strptime("00:00.000",  format = "%M:%OS")
for (ind in seq(1, length(list_df))){
list_df[[ind]][, "Время"] <-  seq.POSIXt(from = start_date, to = start_date + 0.004 * (nrow(list_df[[ind]])-1),
units = "seconds", by = .004, format = "%M:OS")
colnames(list_df[[ind]]) <- c("Период", names, "Время")
}
for (ind in seq(1, length(list_df))){
list_df[[ind]][, "Время"] <-  seq.POSIXt(from = start_date, to = start_date + 0.004 * nrow(list_df[[ind]]),
units = "seconds", by = .004, format = "%M:OS")
colnames(list_df[[ind]]) <- c("Период", names, "Время")
}
start_date <- strptime("00:00.000",  format = "%M:%OS")
for (ind in seq(1, length(list_df))){
if (0.004 * nrow(list_df[[ind]]) %% 1 == 0){
list_df[[ind]][, "Время"] <-  seq.POSIXt(from = start_date, to = start_date + 0.004 * nrow(list_df[[ind]]),
units = "seconds", by = .004, format = "%M:OS")
} else {
list_df[[ind]][, "Время"] <-  seq.POSIXt(from = start_date, to = start_date + 0.004 * (nrow(list_df[[ind]])-1),
units = "seconds", by = .004, format = "%M:OS")
}
colnames(list_df[[ind]]) <- c("Период", names, "Время")
}
start_date <- strptime("00:00.000",  format = "%M:%OS")
for (ind in seq(1, length(list_df))){
if (0.004 * nrow(list_df[[ind]]) == nrow(list_df[[ind]])){
list_df[[ind]][, "Время"] <-  seq.POSIXt(from = start_date, to = start_date + 0.004 * nrow(list_df[[ind]]),
units = "seconds", by = .004, format = "%M:OS")
} else {
list_df[[ind]][, "Время"] <-  seq.POSIXt(from = start_date, to = start_date + 0.004 * (nrow(list_df[[ind]])-1),
units = "seconds", by = .004, format = "%M:OS")
}
colnames(list_df[[ind]]) <- c("Период", names, "Время")
}
start_date <- strptime("00:00.000",  format = "%M:%OS")
for (ind in seq(1, length(list_df))){
if (0.004 * nrow(list_df[[ind]]) == nrow(list_df[[ind]])){
list_df[[ind]][, "Время"] <-  seq.POSIXt(from = start_date, to = start_date + 0.004 * nrow(list_df[[ind]]),
units = "seconds", by = .004, format = "%M:OS")
} else if (0.004 * nrow(list_df[[ind]]) > nrow(list_df[[ind]])){
list_df[[ind]][, "Время"] <-  seq.POSIXt(from = start_date, to = start_date + 0.004 * (nrow(list_df[[ind]])-1),
units = "seconds", by = .004, format = "%M:OS")
} else {
list_df[[ind]][, "Время"] <-  seq.POSIXt(from = start_date, to = start_date + 0.004 * (nrow(list_df[[ind]])+1),
units = "seconds", by = .004, format = "%M:OS")
}
colnames(list_df[[ind]]) <- c("Период", names, "Время")
}
start_date <- strptime("00:00.000",  format = "%M:%OS")
for (ind in seq(1, length(list_df))){
if (0.004 * nrow(list_df[[ind]]) == nrow(list_df[[ind]])){
list_df[[ind]][, "Время"] <-  seq.POSIXt(from = start_date, to = start_date + 0.004 * nrow(list_df[[ind]]),
units = "seconds", by = .004, format = "%M:OS")
} else if (0.004 * nrow(list_df[[ind]]) > nrow(list_df[[ind]])){
list_df[[ind]][, "Время"] <-  seq.POSIXt(from = start_date, to = start_date + 0.004 * (nrow(list_df[[ind]]) - 1),
units = "seconds", by = .004, format = "%M:OS")
} else {
list_df[[ind]][, "Время"] <-  seq.POSIXt(from = start_date, to = start_date + 0.004 * (nrow(list_df[[ind]]) + 1),
units = "seconds", by = .004, format = "%M:OS")
}
colnames(list_df[[ind]]) <- c("Период", names, "Время")
}
list_df <- list()
cur_ind <- 1
index_vec <- which(df[, 1] == 0, arr.ind=T)
for (ind in seq(1, length(index_vec))){
if (ind == 1){
list_df[[cur_ind]] <- df[c(1:(index_vec[ind] - 7)), ]
cur_ind <- cur_ind + 1
} else {
list_df[[cur_ind]] <- df[c(index_vec[ind-1]:(index_vec[ind] - 7)), ]
cur_ind <- cur_ind + 1
}
}
list_df[cur_ind] <- df[c(index_vec[length(index_vec)-1]:length(df)), ]
#количество опытов
length(list_df)
#-------------------(5)
start_date <- strptime("00:00.000",  format = "%M:%OS")
for (ind in seq(1, length(list_df))){
if (0.004 * nrow(list_df[[ind]]) == nrow(list_df[[ind]])){
list_df[[ind]][, "Время"] <-  seq.POSIXt(from = start_date, to = start_date + 0.004 * nrow(list_df[[ind]]),
units = "seconds", by = .004, format = "%M:OS")
} else if (0.004 * nrow(list_df[[ind]]) > nrow(list_df[[ind]])){
list_df[[ind]][, "Время"] <-  seq.POSIXt(from = start_date, to = start_date + 0.004 * (nrow(list_df[[ind]]) - 1),
units = "seconds", by = .004, format = "%M:OS")
} else {
list_df[[ind]][, "Время"] <-  seq.POSIXt(from = start_date, to = start_date + 0.004 * (nrow(list_df[[ind]]) + 1),
units = "seconds", by = .004, format = "%M:OS")
}
colnames(list_df[[ind]]) <- c("Период", names, "Время")
}
list_df[[1]]
